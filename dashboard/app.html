<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>K-Vant Dashboard - K-Trend Intelligence</title>
  <meta name="description" content="동남아시아 이커머스 셀러를 위한 한국 이커머스 트렌드 인텔리전스 대시보드. 올리브영, 무신사, 쇼피 실시간 분석." />
  <meta name="robots" content="noindex, nofollow" />
  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="K-Vant - K-Trend Intelligence Dashboard">
  <meta property="og:description" content="AI 기반 글로벌 뷰티/패션 트렌드 분석 플랫폼.">
  <meta property="og:url" content="https://kvant.kr/app.html">
  <!-- Google Analytics 4 (GA4) - Replace G-XXXXXXXXXX with your Measurement ID -->
  <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-XXXXXXXXXX');
  </script> -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
    rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <!-- Header -->
  <header class="header">
    <div class="header-inner">
      <div class="logo" style="display: flex; align-items: center; gap: 10px;">
        <img src="/public/logo_kvant.png" alt="K-Vant Logo" style="height: 28px; border-radius: 4px;">
        <div>K-Vant <span style="font-weight:300; color:#666; font-size:14px;">Intelligence</span></div>
      </div>

      <div class="header-right">
        <div class="search-box">
          <svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
            stroke-width="2">
            <circle cx="11" cy="11" r="8" />
            <path d="m21 21-4.3-4.3" />
          </svg>
          <input type="text" id="searchInput" data-i18n="common.search_placeholder" placeholder="상품명, 브랜드 검색..." />
          <button class="ai-toggle-btn" id="aiSearchToggle" data-i18n-title="common.ai_search_tip"
            title="AI 스마트 검색 사용">✨</button>
        </div>

        <!-- Language Switcher -->
        <div class="lang-selector">
          <button class="header-icon-btn" id="langBtn" title="Change Language">
            <span id="currentLangIcon">🌐</span>
          </button>
          <div class="lang-dropdown" id="langDropdown">
            <div class="lang-item" data-lang="ko"><span class="lang-flag">🇰🇷</span> South Korea</div>
            <div class="lang-item" data-lang="en"><span class="lang-flag">🇺🇸</span> English</div>
            <div class="lang-item" data-lang="vi"><span class="lang-flag">🇻🇳</span> Tiếng Việt</div>
            <div class="lang-item" data-lang="th"><span class="lang-flag">🇹🇭</span> ไทย</div>
            <div class="lang-item" data-lang="id"><span class="lang-flag">🇮🇩</span> Indonesia</div>
            <div class="lang-item" data-lang="ja"><span class="lang-flag">🇯🇵</span> 日本語</div>
          </div>
        </div>

        <div class="notification-wrapper">
          <button class="header-icon-btn" id="notifBell" data-i18n-title="notifications.title">
            <span class="bell-icon">🔔</span>
            <span class="unread-badge" id="notifBadge" style="display:none"></span>
          </button>
          <div class="notif-dropdown" id="notifDropdown">
            <div class="notif-header">
              <h3 data-i18n="notifications.title">실시간 알림</h3>
              <button class="notif-clear-btn" id="clearNotif" data-i18n="notifications.clear_all">비우기</button>
            </div>
            <div class="notif-list" id="notifList">
              <!-- Notifications will be loaded here -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main">
    <!-- New Platform Bar: Centralized Controls -->
    <section class="platform-bar">
      <div class="platform-switcher">
        <button class="platform-btn active" data-platform="oliveyoung" data-i18n="platforms.oliveyoung">Olive
          Young</button>
        <button class="platform-btn" data-platform="musinsa" data-i18n="platforms.musinsa">Musinsa</button>
        <button class="platform-btn" data-platform="ably" data-i18n="platforms.ably">Ably</button>
        <button class="platform-btn" data-platform="ssg" data-i18n="platforms.ssg">Shinsegae</button>
        <button class="platform-btn" data-platform="k_trend" data-i18n="platforms.k_trend">Korea Trends</button>
        <button class="platform-btn" data-platform="steady_sellers" data-i18n="platforms.steady_sellers">Steady
          Sellers</button>
      </div>
      <div id="platformControls" class="platform-controls"></div>
    </section>

    <!-- KPI Cards -->
    <section class="kpi-grid" id="kpiGrid">
      <div class="kpi-card kpi-trending">
        <div class="kpi-icon">🔥</div>
        <div class="kpi-content">
          <div class="kpi-value" id="kpiTrending">-</div>
          <div class="kpi-label" data-i18n="kpi.trending">7일 급상승</div>
        </div>
      </div>
      <div class="kpi-card kpi-deals">
        <div class="kpi-icon">💰</div>
        <div class="kpi-content">
          <div class="kpi-value" id="kpiDeals">-</div>
          <div class="kpi-label" data-i18n="kpi.deals">오늘 할인</div>
        </div>
      </div>
      <div class="kpi-card kpi-reviews">
        <div class="kpi-icon">⭐</div>
        <div class="kpi-content">
          <div class="kpi-value" id="kpiReviews">-</div>
          <div class="kpi-label" data-i18n="kpi.reviews">리뷰 상위</div>
        </div>
      </div>
      <div class="kpi-card kpi-total">
        <div class="kpi-icon">📦</div>
        <div class="kpi-content">
          <div class="kpi-value" id="kpiTotal">-</div>
          <div class="kpi-label" data-i18n="kpi.total">전체 상품</div>
        </div>
      </div>
    </section>

    <!-- Category Filter -->
    <section class="filter-bar">
      <div class="filter-label" data-i18n="filters.category">카테고리</div>
      <div class="category-chips" id="categoryChips">
      </div>
    </section>

    <!-- Tab Navigation -->
    <section class="tab-bar">
      <button class="tab active" data-tab="all"><span>📋</span> <span data-i18n="tabs.all">전체 상품</span></button>
      <button class="tab" data-tab="trending"><span>🔥</span> <span data-i18n="tabs.trending">급상승 TOP</span></button>
      <button class="tab" data-tab="deals"><span>💰</span> <span data-i18n="tabs.deals">할인 특가</span></button>
      <button class="tab" data-tab="reviews"><span>⭐</span> <span data-i18n="tabs.reviews">리뷰 인기</span></button>
      <button class="tab" data-tab="wishlist"><span>❤️</span> <span data-i18n="tabs.favorites">관심 상품</span></button>
      <button class="tab" data-tab="insights"><span>📊</span> <span data-i18n="tabs.insights">시장 분석</span></button>
      <!-- <button class="tab" data-tab="logs"><span>📋</span> <span data-i18n="tabs.crawl_logs">수집 로그</span></button> -->
    </section>

    <!-- Content Area -->
    <section class="content-area">
      <!-- Trending Tab -->
      <div class="tab-content" id="tab-trending">
        <div class="section-header">
          <h2 data-i18n="sections.trending">7일간 급상승 상품</h2>
          <p class="section-desc" data-i18n="sections.trending_desc">최근 7일 동안 랭킹이 가장 크게 상승한 상품들</p>
        </div>
        <div class="products-grid" id="trendingGrid">
          <div class="loading-skeleton"></div>
        </div>
      </div>

      <!-- Deals Tab -->
      <div class="tab-content" id="tab-deals">
        <div class="section-header">
          <h2 data-i18n="sections.deals">오늘의 특가 할인</h2>
          <p class="section-desc" data-i18n="sections.deals_desc">가장 큰 폭으로 할인 중인 상품들</p>
        </div>
        <div class="products-grid" id="dealsGrid">
          <div class="loading-skeleton"></div>
        </div>
      </div>

      <!-- Reviews Tab -->
      <div class="tab-content" id="tab-reviews">
        <div class="section-header">
          <h2 data-i18n="sections.reviews">리뷰 인기 상품</h2>
          <p class="section-desc" data-i18n="sections.reviews_desc">리뷰 수가 가장 많은 검증된 인기 상품들</p>
        </div>
        <div class="products-grid" id="reviewsGrid">
          <div class="loading-skeleton"></div>
        </div>
      </div>

      <!-- Wishlist Tab -->
      <div class="tab-content" id="tab-wishlist">
        <div class="section-header">
          <h2 data-i18n="sourcing.cart_title">나의 관심 상품 & 소싱 카트</h2>
          <p class="section-desc" data-i18n="sourcing.cart_desc">찜한 상품들을 체계적으로 모아보고 B2B 견적을 요청하세요</p>
        </div>
        <div class="products-grid" id="wishlistGrid">
          <div class="loading-skeleton"></div>
        </div>
        <div class="sourcing-action-bar" id="sourcingActionBar"
          style="display:none; margin-top: 30px; text-align: center; background: var(--bg-card); padding: 20px; border-radius: 12px; border: 1px solid var(--border); box-shadow: var(--shadow-sm);">
          <button class="btn-primary" id="btnRequestQuote"
            style="width: 100%; padding: 15px; font-size: 16px; border-radius: 12px; border: none; background: var(--accent-blue); color: #fff; cursor: pointer; font-weight: 700; box-shadow: var(--shadow-sm); transition: transform 0.2s;"
            onmouseover="this.style.transform='scale(1.02)'" onmouseout="this.style.transform='scale(1)'"
            onclick="openQuoteModal()" data-i18n="sourcing.btn_request_quote">📦 카트에 담긴 상품 견적 요청하기</button>
        </div>
      </div>

      <!-- Global Trends Tab (Korea Trend AI Mining) -->
      <div class="tab-content" id="tab-global_trends">
        <div class="section-header">
          <h2 data-i18n="sections.global_trends">글로벌 실구매 트렌드</h2>
          <p class="section-desc" data-i18n="sections.global_trends_desc">해외에서 먼저 검증된 한국 상품 인기 리스트</p>
        </div>
        <div class="products-grid" id="global_trendsGrid">
          <div class="loading-skeleton"></div>
        </div>
      </div>

      <!-- Insights Tab -->
      <div class="tab-content" id="tab-insights">
        <div class="section-header">
          <h2 data-i18n="sections.insights">시장 인지도 및 분석</h2>
          <p class="section-desc" data-i18n="sections.insights_desc">현재 수집된 데이터를 바탕으로 한 시장 종합 통계입니다.</p>
        </div>
        <div class="insights-grid">
          <div class="insight-card">
            <h3 data-i18n="insights.category_share">📂 카테고리별 점유율</h3>
            <div class="chart-wrapper">
              <canvas id="categoryShareChart"></canvas>
            </div>
          </div>
          <div class="insight-card">
            <h3 data-i18n="insights.brand_power">🏷️ 브랜드 파워 TOP 10</h3>
            <div class="chart-wrapper">
              <canvas id="brandPowerChart"></canvas>
            </div>
          </div>
          <div class="insight-card full-width">
            <h3 data-i18n="insights.price_range">💰 가격대별 상품 분포</h3>
            <div class="chart-wrapper">
              <canvas id="priceRangeChart"></canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- Logs Tab -->
      <div class="tab-content" id="tab-logs" style="display:none!important;">
        <div class="section-header">
          <h2 data-i18n="sections.logs">데이터 수집 로그</h2>
          <p class="section-desc" data-i18n="sections.logs_desc">최근 30일간의 수집 성공/실패 기록입니다.</p>
        </div>
        <div class="log-container">
          <table class="data-table">
            <thead>
              <tr>
                <th data-i18n="table.time">수집 시간</th>
                <th data-i18n="table.job">작업명</th>
                <th data-i18n="table.status">상태</th>
                <th data-i18n="table.count">수집량</th>
                <th data-i18n="table.message">메시지</th>
              </tr>
            </thead>
            <tbody id="crawlLogsBody">
              <tr>
                <td colspan="5" style="text-align:center; padding:40px;">데이터를 불러오는 중...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="tab-content active" id="tab-all">
        <div class="section-header">
          <h2 id="rankingTitle" data-i18n="sections.all">카테고리별 랭킹</h2>
          <p id="rankingDesc" class="section-desc" data-i18n="sections.all_desc">올리브영 카테고리별 순위 기반 상품 목록</p>
        </div>
        <div class="table-container">
          <table class="data-table" id="allProductsTable">
            <thead>
              <tr>
                <th data-i18n="table.rank">순위</th>
                <th data-i18n="table.image">이미지</th>
                <th class="sortable" data-sort="name" data-i18n="table.name">상품명</th>
                <th class="sortable" data-sort="brand" data-i18n="table.brand">브랜드</th>
                <th class="sortable" data-sort="price" data-i18n="table.price">가격</th>
                <th data-i18n="table.review">리뷰</th>
                <th data-i18n="table.rating">평점</th>
                <th data-i18n="table.link">링크</th>
              </tr>
            </thead>
            <tbody id="allProductsBody">
              <tr>
                <td colspan="8" class="loading-cell">데이터 로딩 중...</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="pagination" id="pagination"></div>
      </div>
    </section>
  </main>

  <!-- Product Detail Modal -->
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal" id="productModal">
      <button class="modal-close" id="modalClose">&times;</button>
      <div class="modal-body" id="modalBody"></div>
    </div>
  </div>

  <!-- Quote Request Modal -->
  <div class="modal-overlay" id="quoteModalOverlay">
    <div class="modal" id="quoteModal" style="max-width: 500px; padding: 30px;">
      <button class="modal-close" onclick="closeQuoteModal()">&times;</button>
      <h2 style="margin-bottom: 20px;" data-i18n="sourcing.modal_title">📦 B2B 소싱 견적 요청</h2>
      <div style="margin-bottom: 20px;">
        <p style="margin-bottom: 15px; color: var(--text-muted); font-size: 14px; line-height: 1.5;"
          data-i18n="sourcing.modal_desc">카트에 담긴 관심 상품들에 대한 매입 단가 및 배송비 견적을 K-Vant 에 요청합니다. 선택하신 상품 목록과 수량을 확인해 주세요.</p>

        <!-- Product List Preview -->
        <div id="quoteProductList"
          style="margin-bottom: 15px; max-height: 220px; overflow-y: auto; border: 1px solid var(--border); border-radius: 8px; padding: 10px 15px; background: var(--surface-light);">
          <!-- Populated dynamically via JS -->
        </div>

        <textarea id="quoteMessage" class="form-input" rows="4" data-i18n="sourcing.modal_placeholder"
          placeholder="추가 요구사항을 남겨주세요 (예: 베트남 호치민으로 이달 말까지 배송 원합니다.)"
          style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; resize: vertical; margin-bottom: 10px;"></textarea>

        <input type="url" id="quoteSnsLink" class="form-input" data-i18n="sourcing.modal_sns_placeholder"
          placeholder="📌 원하시는 상품 이미지 URL 또는 SNS 링크 (선택)"
          style="width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px; background: #fafafa;">
        <div
          style="margin-top: 15px; margin-bottom: 20px; padding: 12px; border-radius: 8px; background: rgba(255, 77, 79, 0.05); border: 1px solid rgba(255, 77, 79, 0.2);">
          <p style="color: #ff4d4f; font-size: 13px; font-weight: 500; line-height: 1.5; margin: 0; display: flex; gap: 8px;"
            data-i18n="sourcing.modal_warning">
            ⚠️ 견적 산출에는 약간의 시간이 소요될 수 있습니다. 완료 시 대시보드 알림과 메일로 안내해 드립니다.
          </p>
        </div>
      </div>
      <button class="btn-primary" id="btnSubmitQuote"
        style="width: 100%; padding: 16px; border-radius: 12px; border: none; font-size: 16px; font-weight: 700; cursor: pointer; color: white; background: var(--accent-blue); box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);"
        onclick="submitQuoteRequest()" data-i18n="sourcing.btn_submit">견적 요청 전송</button>
    </div>
  </div>

  <!-- My Page Modal -->
  <div class="modal-overlay" id="myPageModalOverlay">
    <div class="modal my-page-modal" id="myPageModal">
      <button class="modal-close" id="myPageModalClose">&times;</button>
      <h2 class="my-page-title" data-i18n="mypage.title">마이페이지</h2>
      <div class="auth-tabs" style="margin-bottom: 24px;">
        <button class="auth-tab active" data-mypage-tab="account" data-i18n="mypage.account">계정 관리</button>
        <button class="auth-tab" data-mypage-tab="billing" data-i18n="mypage.billing">결제 관리</button>
        <button class="auth-tab" data-mypage-tab="sourcing" data-i18n="sourcing.mypage_tab">견적/소싱 내역</button>
        <button class="auth-tab" data-mypage-tab="support" data-i18n="support.title">고객센터</button>
      </div>

      <div class="my-page-content" id="myPageAccountTab">
        <div class="form-group">
          <label data-i18n="mypage.email">이메일</label>
          <input type="text" id="myPageEmail" disabled class="form-input disabled-input">
        </div>
        <div class="form-group">
          <label>연락처 (Phone)</label>
          <input type="text" id="myPagePhone" class="form-input" placeholder="연락처를 입력하세요">
        </div>
        <div class="form-group">
          <label>배송지 주소 (Address)</label>
          <input type="text" id="myPageAddress" class="form-input" placeholder="배송지 주소를 입력하세요">
        </div>
        <div class="form-group">
          <label data-i18n="mypage.role">권한 (Role)</label>
          <input type="text" id="myPageRole" disabled class="form-input disabled-input">
        </div>
        <div style="margin-top: 20px; text-align: right;">
          <button id="btnSaveProfile" class="btn-primary"
            style="padding: 10px 20px; border-radius: 8px; border: none; background: var(--accent-blue); color: white; font-weight: 600; cursor: pointer;">저장하기</button>
        </div>
        <div style="margin-top: 40px; padding-top: 20px; border-top: 1px solid var(--border); text-align: right;">
          <button id="btnDeleteAccount" class="btn-secondary"
            style="padding: 8px 16px; border-radius: 8px; border: 1px solid #ffc9c9; background: #fff5f5; color: #e03131; font-weight: 600; cursor: pointer;">회원
            탈퇴</button>
        </div>
      </div>

      <div class="my-page-content" id="myPageBillingTab" style="display:none;">
        <div class="billing-card">
          <div class="billing-header">
            <h3 data-i18n="mypage.current_plan">현재 구독 플랜</h3>
            <span class="plan-badge" id="myPagePlanBadge">Free</span>
          </div>
          <p class="billing-desc" id="myPagePlanDesc">현재 무료 플랜을 이용 중입니다. (일일 조회 10회 제한)</p>

          <div class="billing-info-row">
            <span class="info-label" data-i18n="mypage.expires_at">만료 예정일</span>
            <span class="info-value" id="myPageExpiresAt">-</span>
          </div>
        </div>

        <div class="billing-actions" style="margin-top: 24px; text-align:center;">
          <div id="paypal-button-container" style="max-width: 400px; margin: 0 auto;"></div>
          <button id="cancelSubscriptionBtn" class="btn-secondary"
            style="display:none; width: 100%; max-width: 400px; margin: 0 auto; padding: 12px; background: #fff5f5; color: #e03131; border: 1px solid #ffc9c9; border-radius: 8px; cursor: pointer; font-weight: 600;">구독
            취소 (Cancel Subscription)</button>
        </div>
      </div>

      <!-- Sourcing History Tab -->
      <div class="my-page-content" id="myPageSourcingTab" style="display: none;">
        <h3 style="font-size: 16px; margin-bottom: 15px;" data-i18n="sourcing.history_title">📦 나의 소싱 견적 내역</h3>
        <div id="sourcingHistoryList"
          style="max-height: 400px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px;">
          <div class="loading-skeleton"></div>
        </div>
      </div>

      <!-- Customer Center Tab -->
      <div class="my-page-content" id="myPageSupportTab" style="display: none;">
        <div class="support-header" style="display: flex; gap: 10px; margin-bottom: 20px;">
          <button class="chip active" onclick="window.toggleSupportView('faq')" data-i18n="support.faq"
            id="btnSupportFaq">FAQ (자주 묻는 질문)</button>
          <button class="chip" onclick="window.toggleSupportView('inquiry')" data-i18n="support.inquiry"
            id="btnSupportInquiry">1:1 문의 & 건의사항</button>
        </div>

        <!-- FAQ View -->
        <div id="supportFaqView">
          <div id="faqList"
            style="display: flex; flex-direction: column; gap: 10px; max-height: 400px; overflow-y: auto;">
            <div class="loading-skeleton"></div>
          </div>
        </div>

        <!-- Inquiry View -->
        <div id="supportInquiryView" style="display: none;">
          <div
            style="margin-bottom: 20px; background: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #eee;">
            <h4 style="margin-bottom: 10px; font-size: 14px;">새 문의 작성</h4>
            <select id="inquiryType" class="form-input"
              style="margin-bottom: 10px; width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #ddd;">
              <option value="inquiry">1:1 문의사항</option>
              <option value="feedback">서비스 건의/요청</option>
            </select>
            <input type="text" id="inquiryTitle" class="form-input" placeholder="제목을 입력해주세요"
              style="margin-bottom: 10px; width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #ddd;">
            <textarea id="inquiryMessage" class="form-input" rows="4" placeholder="문의 내용이나 건의사항을 상세히 작성해주세요."
              style="margin-bottom: 10px; width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #ddd; resize: vertical;"></textarea>
            <button onclick="window.submitSupportInquiry()" class="btn-primary"
              style="width: 100%; padding: 10px; border-radius: 6px; border: none; background: var(--accent-blue); color: white; cursor: pointer; font-weight: 600;">등록하기</button>
          </div>

          <h4 style="margin-bottom: 10px; font-size: 14px; border-top: 1px solid #eee; padding-top: 20px;">나의 문의 내역</h4>
          <div id="inquiryList"
            style="display: flex; flex-direction: column; gap: 10px; max-height: 250px; overflow-y: auto;">
            <div class="loading-skeleton"></div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <footer class="footer">
    <p data-i18n="common.footer_text">K-Trend Intelligence © 2026 · Global K-Beauty & Fashion Intelligence · Analytics
      for Global Sellers · K-Vant</p>
    <div class="footer-links"
      style="margin-top: 8px; display: flex; gap: 16px; justify-content: center; flex-wrap: wrap; opacity: 0.8;">
      <a href="/terms.html" data-i18n-href="common.terms_url"
        style="color: var(--text-secondary); font-size: 13px; text-decoration: none;">이용약관</a>
      <a href="/privacy.html" data-i18n-href="common.privacy_url"
        style="color: var(--text-secondary); font-size: 13px; text-decoration: none;">개인정보 처리방침</a>
      <a href="mailto:contact@k-vant.kr"
        style="color: var(--text-secondary); font-size: 13px; text-decoration: none;">문의하기</a>
    </div>
  </footer>

  <script type="module" src="/main.js?v=26"></script>
  <!-- Reliable body[data-platform] setter independent of ES module system -->
  <script>
    document.addEventListener('click', function (e) {
      var btn = e.target.closest('.platform-btn');
      if (btn && btn.dataset.platform) {
        document.body.dataset.platform = btn.dataset.platform;
      }
    });
  </script>
</body>

</html>